-- Практическое задание по теме “CRUD - операции”
-- 1. Повторить все действия по доработке БД ВК: структура таблиц и данные
-- 2. Подобрать сервис который будет служить основой для вашей курсовой работы.
-- 3. (по желанию) Предложить свою реализацию лайков и постов.
 
 
DROP DATABASE vk;
CREATE DATABASE vk;
USE vk;


CREATE TABLE `likes` (
	`id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
	`post_id` INT UNSIGNED DEFAULT NULL COMMENT 'post id from posts',
	`user_like_id` INT UNSIGNED DEFAULT NULL COMMENT 'user id from users',
	`like_date` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'date of like creation',
	PRIMARY KEY (`id`),
	KEY `fk_post_like_id` (`post_id`),
	KEY `fk_user_post_id` (`user_like_id`),
	CONSTRAINT `fk_post_like_id` FOREIGN KEY (`post_id`) REFERENCES `posts`(`id`),
	CONSTRAINT `fk_user_like_id` FOREIGN KEY (`user_like_id`) REFERENCES `users`(`id`));

CREATE TABLE `posts` (
	`id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
	`user_id` INT UNSIGNED DEFAULT NULL COMMENT 'user id from users',
	`message` VARCHAR(5000) CHARACTER SET utf8 COLLATE utf8_general_ci DEFAULT NULL,
	`media` INT DEFAULT NULL COMMENT 'link to media from appropriate table',
	`deleted` TINYINT(1) DEFAULT '0',
	PRIMARY KEY (`id`),
	KEY `fk_user_id` (`user_id`),
	CONSTRAINT `fk_user_id` FOREIGN KEY (`user_id`) REFERENCES `users`(`id`));

 DROP TABLE IF EXISTS `users`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!50503 SET character_set_client = utf8mb4 */;
CREATE TABLE `users` (
  `id` int unsigned NOT NULL AUTO_INCREMENT COMMENT 'Идентификатор строки',
  `email` varchar(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL COMMENT 'Почта',
  `phone` varchar(100) CHARACTER SET utf8 COLLATE utf8_unicode_ci NOT NULL COMMENT 'Телефон',
  `created_at` datetime DEFAULT CURRENT_TIMESTAMP COMMENT 'Время создания строки',
  `updated_at` datetime DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'Время обновления строки',
  PRIMARY KEY (`id`),
  UNIQUE KEY `email` (`email`),
  UNIQUE KEY `phone` (`phone`)
) ENGINE=InnoDB AUTO_INCREMENT=101 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Пользователи';
/*!40101 SET character_set_client = @saved_cs_client */;
 